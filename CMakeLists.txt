# vim: set ts=4 sw=4 sts=4 et:

PROJECT (sqlite3pp)
CMAKE_MINIMUM_REQUIRED (VERSION 2.6)

SET (SQLITE3PP_MAJOR 1)
SET (SQLITE3PP_MINOR 0)
SET (SQLITE3PP_MICRO 1)

OPTION (ENABLE_SQLCIPHER "Enable building with sqlcipher" OFF)
OPTION (ENABLE_TESTS "Enable building tests" ON)

IF (ENABLE_SQLCIPHER)
    ADD_DEFINITIONS (-DHAVE_SQLCIPHER=1 -DSQLITE_HAS_CODEC)
    SET (SQLITE3PP_NAME sqlcipherpp)
    SET (SQLITE3 sqlcipher)
ELSE (ENABLE_SQLCIPHER)
    SET (SQLITE3PP_NAME sqlite3pp)
    SET (SQLITE3 sqlite3)
ENDIF (ENABLE_SQLCIPHER)

INCLUDE_DIRECTORIES ($ENV{BOOST_ROOT})

IF (NOT WIN32)
    SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall")
    IF (CMAKE_COMPILER_IS_GNUCC)
        INCLUDE (CheckCXXCompilerFlag)
        CHECK_CXX_COMPILER_FLAG (-fvisibility=hidden HAVE_GCC_VISIBILITY)
        IF (HAVE_GCC_VISIBILITY)
            SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fvisibility=hidden")
        ENDIF (HAVE_GCC_VISIBILITY)
    ENDIF (CMAKE_COMPILER_IS_GNUCC)
ENDIF (NOT WIN32)

ADD_SUBDIRECTORY (src)

IF (ENABLE_TESTS)
    ADD_SUBDIRECTORY (tests)
ENDIF (ENABLE_TESTS)
